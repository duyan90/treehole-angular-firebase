(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{xZLo:function(t,e,s){"use strict";s.r(e),s.d(e,"PostsModule",(function(){return q}));var n=s("AcyG"),i=s("3Pt+"),o=s("PCNd"),c=s("tyNb"),r=s("n90j"),a=s("quSY"),l=s("zONo"),b=s("Jsfd"),h=s("XKO9"),u=s("B0Pf");let g=(()=>{class t{constructor(t,e){this.language=t,this.sortBy=e}}return t.type="[Posts] Get",t})(),p=(()=>{class t{constructor(t){this.pageIndex=t}}return t.type="[Posts] Change Page Index",t})(),d=(()=>{class t{constructor(t){this.pageSize=t}}return t.type="[Posts] Change Page Size",t})();const z=t=>t.posts,m=t=>z(t).posts,f=Object(n.k)([m],t=>t.length),P=t=>z(t).pageSize,C=Object(n.k)([m,t=>z(t).pageIndex,P],(t,e,s)=>t.slice((e-1)*s,e*s));var y=s("fXoL"),k=s("YaLo"),S=s("ofXK"),T=s("Ff2k"),O=s("3/1E"),w=s("zAKX"),U=s("OzZK"),B=s("C2AL"),I=s("FwiY"),L=s("Mean"),j=s("RwU8"),x=s("sYmb");function v(t,e){if(1&t&&(y.Ub(0,"form",6),y.Ub(1,"nz-select",7),y.Pb(2,"nz-option",8),y.gc(3,"translate"),y.Pb(4,"nz-option",8),y.gc(5,"translate"),y.Pb(6,"nz-option",8),y.gc(7,"translate"),y.Pb(8,"nz-option",8),y.gc(9,"translate"),y.Pb(10,"nz-option",8),y.gc(11,"translate"),y.Tb(),y.Tb()),2&t){const t=y.fc();y.lc("formGroup",t.searchForm),y.Cb(2),y.lc("nzValue",t.SortBy.NewestPosts)("nzLabel",y.hc(3,11,t.SortBy.NewestPosts)),y.Cb(2),y.lc("nzValue",t.SortBy.OldestPosts)("nzLabel",y.hc(5,13,t.SortBy.OldestPosts)),y.Cb(2),y.lc("nzValue",t.SortBy.MostLikes)("nzLabel",y.hc(7,15,t.SortBy.MostLikes)),y.Cb(2),y.lc("nzValue",t.SortBy.MostDislikes)("nzLabel",y.hc(9,17,t.SortBy.MostDislikes)),y.Cb(2),y.lc("nzValue",t.SortBy.MostComments)("nzLabel",y.hc(11,19,t.SortBy.MostComments))}}const F=function(t){return["/post",t]};function D(t,e){if(1&t){const t=y.Vb();y.Ub(0,"nz-list-item",9),y.Ub(1,"nz-list-item-meta"),y.Ub(2,"nz-list-item-meta-title"),y.Ub(3,"a",10),y.Dc(4),y.Tb(),y.Tb(),y.Ub(5,"nz-list-item-meta-description"),y.Dc(6),y.gc(7,"date"),y.Tb(),y.Tb(),y.Ub(8,"a",10),y.Dc(9),y.Tb(),y.Ub(10,"ul",11),y.Ub(11,"nz-list-item-action"),y.Ub(12,"button",12),y.cc("click",(function(){y.tc(t);const s=e.$implicit;return y.fc().like(s)})),y.Pb(13,"i",13),y.gc(14,"async"),y.Dc(15),y.Tb(),y.Tb(),y.Ub(16,"nz-list-item-action"),y.Ub(17,"button",12),y.cc("click",(function(){y.tc(t);const s=e.$implicit;return y.fc().dislike(s)})),y.Pb(18,"i",14),y.gc(19,"async"),y.Dc(20),y.Tb(),y.Tb(),y.Ub(21,"nz-list-item-action"),y.Ub(22,"a",10),y.Pb(23,"i",15),y.Dc(24),y.Tb(),y.Tb(),y.Tb(),y.Tb()}if(2&t){const t=e.$implicit,s=y.fc();y.lc("nzNoFlex",!0),y.Cb(3),y.lc("routerLink",y.oc(19,F,t.id)),y.Cb(1),y.Ec(t.title),y.Cb(2),y.Fc(" ",y.ic(7,12,t.createdAt,"medium")," "),y.Cb(2),y.lc("routerLink",y.oc(21,F,t.id)),y.Cb(1),y.Ec(t.message),y.Cb(4),y.lc("nzTheme",y.hc(14,15,s.doesUserLikesComment$(t.id))?"fill":"outline"),y.Cb(2),y.Fc(" ",t.likesCount," "),y.Cb(3),y.lc("nzTheme",y.hc(19,17,s.doesUserDislikesComment$(t.id))?"fill":"outline"),y.Cb(2),y.Fc(" ",t.dislikesCount," "),y.Cb(2),y.lc("routerLink",y.oc(23,F,t.id)),y.Cb(2),y.Fc(" ",t.commentsCount," ")}}function $(t,e){if(1&t){const t=y.Vb();y.Ub(0,"nz-result",16),y.gc(1,"translate"),y.Ub(2,"div",17),y.Ub(3,"button",18),y.cc("click",(function(){return y.tc(t),y.fc().getPosts()})),y.Dc(4),y.gc(5,"translate"),y.Tb(),y.Tb(),y.Tb()}2&t&&(y.lc("nzTitle",y.hc(1,2,"MESSAGES.FAILED")),y.Cb(4),y.Fc(" ",y.hc(5,4,"RETRY")," "))}const N=[{path:"",component:(()=>{class t{constructor(t,e,s){this.store=t,this.actions=e,this.likeDislikeService=s,this.posts=[],this.searchForm=new i.f({sortBy:new i.c(l.a.NewestPosts)}),this.SortBy=l.a,this.loading=!0,this.hasError=!1,this.subscription=new a.a}ngOnInit(){this.getPosts(),this.subscription.add(this.actions.pipe(Object(n.o)(b.a)).subscribe(()=>{this.getPosts()})),this.subscription.add(this.searchForm.get("sortBy").valueChanges.subscribe(()=>{this.getPosts()})),this.subscription.add(this.store.select(C).subscribe(t=>{this.posts=Object(r.a)(t)})),this.totalPostNumber$=this.store.select(f),this.pageSize$=this.store.select(P),this.pageIndex$=this.store.select(P)}ngOnDestroy(){this.subscription.unsubscribe()}getPosts(){this.store.dispatch(new g(this.store.selectSnapshot(h.a),this.searchForm.value.sortBy)).subscribe(()=>{this.loading=!1,this.hasError=!1},()=>{this.loading=!1,this.hasError=!0})}onPageIndexChange(t){this.store.dispatch(new p(t))}onPageSizeChange(t){this.store.dispatch(new d(t))}doesUserLikesComment$(t){return this.store.select(Object(u.b)(t))}doesUserDislikesComment$(t){return this.store.select(Object(u.a)(t))}like(t){this.likeDislikeService.like(this.doesUserLikesComment$(t.id),this.doesUserDislikesComment$(t.id),t)}dislike(t){this.likeDislikeService.dislike(this.doesUserLikesComment$(t.id),this.doesUserDislikesComment$(t.id),t)}}return t.\u0275fac=function(e){return new(e||t)(y.Ob(n.h),y.Ob(n.b),y.Ob(k.a))},t.\u0275cmp=y.Ib({type:t,selectors:[["app-posts-home"]],decls:9,vars:14,consts:[["class","mb3",3,"formGroup",4,"ngIf"],["nzItemLayout","vertical",1,"bg-white",3,"nzLoading","nzBordered"],[3,"nzNoFlex",4,"ngFor","ngForOf"],[1,"tc","mt3"],["nzShowSizeChanger","",3,"nzPageIndex","nzPageSize","nzTotal","nzPageSizeChang","nzPageIndexChange"],["nzStatus","warning",3,"nzTitle",4,"ngIf"],[1,"mb3",3,"formGroup"],["formControlName","sortBy"],[3,"nzValue","nzLabel"],[3,"nzNoFlex"],[3,"routerLink"],["nz-list-item-actions",""],["nz-button","","nzType","link",3,"click"],["nz-icon","","nzType","like",3,"nzTheme"],["nz-icon","","nzType","dislike",3,"nzTheme"],["nz-icon","","nzType","comment"],["nzStatus","warning",3,"nzTitle"],["nz-result-extra",""],["nz-button","","nzType","primary",3,"click"]],template:function(t,e){1&t&&(y.Bc(0,v,12,21,"form",0),y.Ub(1,"nz-list",1),y.Bc(2,D,25,25,"nz-list-item",2),y.Tb(),y.Ub(3,"div",3),y.Ub(4,"nz-pagination",4),y.cc("nzPageSizeChang",(function(t){return e.onPageSizeChange(t)}))("nzPageIndexChange",(function(t){return e.onPageIndexChange(t)})),y.gc(5,"async"),y.gc(6,"async"),y.gc(7,"async"),y.Tb(),y.Tb(),y.Bc(8,$,6,6,"nz-result",5)),2&t&&(y.lc("ngIf",!e.loading&&!e.hasError),y.Cb(1),y.lc("nzLoading",e.loading)("nzBordered",!0),y.Cb(1),y.lc("ngForOf",e.posts),y.Cb(2),y.lc("nzPageIndex",y.hc(5,8,e.pageIndex$))("nzPageSize",y.hc(6,10,e.pageSize$))("nzTotal",y.hc(7,12,e.totalPostNumber$)),y.Cb(4),y.lc("ngIf",!e.loading&&e.hasError))},directives:[S.l,T.a,S.k,O.a,i.r,i.n,i.g,w.b,i.m,i.e,w.a,T.d,T.e,T.g,c.h,T.f,T.c,T.b,U.a,B.a,I.a,L.a,L.b,j.a],pipes:[S.b,x.c,S.e],styles:[""]}),t})(),data:{reuse:!0}}];let E=(()=>{class t{}return t.\u0275mod=y.Mb({type:t}),t.\u0275inj=y.Lb({factory:function(e){return new(e||t)},imports:[[c.i.forChild(N)],c.i]}),t})();var M=s("lJxs"),V=s("bO7i"),A=s("I/3d");let G=(()=>{class t{constructor(t){this.firestore=t}getPosts(t="en",e,s=null){const{orderByField:n,orderByDirection:i}=l.b[e];return this.firestore.collection("posts",e=>{let o=e.where("language","==",t).orderBy(n,i);return s&&(o=e.startAfter(s)),o}).get().pipe(Object(M.a)(t=>t.docs.map(t=>{const e=Object(V.a)(t.data());return e.id=t.id,e})))}}return t.\u0275fac=function(e){return new(e||t)(y.Yb(A.a))},t.\u0275prov=y.Kb({token:t,factory:t.\u0275fac}),t})();var Y=s("mrSG"),K=s("vkgz"),J=s("JIr8"),X=s("EBwW");const R={posts:null,pageIndex:1,pageSize:10};let Z=(()=>{let t=class{constructor(t){this.postsSerivce=t}getPosts(t,e){return t.patchState({posts:null}),this.postsSerivce.getPosts(e.language,e.sortBy).pipe(Object(K.a)(e=>{if(!e||!e.length)throw e;t.patchState({posts:e})}),Object(J.a)(e=>{throw t.dispatch(new X.a),e}))}changePostsPageIndex(t,e){t.patchState({pageIndex:e.pageIndex})}changePostsPageNumber(t,e){t.patchState({pageSize:e.pageSize})}};return t.\u0275fac=function(e){return new(e||t)(y.Yb(G))},t.\u0275prov=y.Kb({token:t,factory:t.\u0275fac}),Object(Y.a)([Object(n.a)(g)],t.prototype,"getPosts",null),Object(Y.a)([Object(n.a)(p)],t.prototype,"changePostsPageIndex",null),Object(Y.a)([Object(n.a)(d)],t.prototype,"changePostsPageNumber",null),t=Object(Y.a)([Object(n.f)({name:"posts",defaults:Object.assign({},R)})],t),t})(),q=(()=>{class t{}return t.\u0275mod=y.Mb({type:t}),t.\u0275inj=y.Lb({factory:function(e){return new(e||t)},providers:[G],imports:[[o.a,E,n.e.forFeature([Z]),i.h,i.p]]}),t})()}}]);